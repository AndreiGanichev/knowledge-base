---
date: 2025-09-16
---
# History

## Общие понятия

*Алфавит открытого текста* - алфавит, используемый для созданий исходного сообщения.
*Шифралфавит* - его буквы подставляются вместо букв алфавита открытого текста.

*Алгоритм* и *ключ* шифрования определяют детали конкретного способа шифрования. Например, алгоритм может заключаться в замене каждой буквы в алфавите открытого текста буквой из шифралфавита. А ключ определяет какой именно шифралфавит используется.

> Стойкость кроптосистемы не должна зависть от стойкости криптоалгоритма. Она зависит только от стойкости ключа. Огюст Керкхофф Военная криптография 1883

Помимо того, что ключ должен хранится в секрете, стойкая система шфирования должна также обладать широким набором возможных ключей.

История шифрования представляет собой борьбу шифровальщиков(криптографов) и дешифровальщиков(криптоаналитиков). Шифровальщики разрабатывают новый шифр, криптоаналитики пробуют разные способы атаки на этот шифр до тех пор пока не смогут расшифровать. Саймон Сингх сравнивает работу криптоаналитиков со скалолазанием: необходимо найти изъяны шифра (неровности в отвесной скале), за которые можно зацепиться. После того как шифр расшифрован все начинается заново.

Способы тайнописи можно классифицировать:

1. стеганография - скрытые сообщения
2. криптография - зашифрованные сообщения
 - замена:
  * шифрование
  * кодирование
- перестановка

## Одноалфавитный шифр замены

### Шифр Цезаря

Шифралфавит представляет собой алфавит открытого текста, сдвинутый на несколько позиций.
Достоинством является простота ключа, недостатоком - малое количество возможных ключей - соответствует количеству букв в алфавите `n`. Для увеличения количества ключей можно использовать в качестве шифралфавита не сдвиг, а произвольную перестановку букв алфавита открытого текста. В этом случае количество возможных шифралфавитов будет `n!`.

В общем случае такой способ шифрования называется *одноалфавитный шифр замены*, потому что один раз определяется шифралфавит и он используется для шифрования всего сообщения. При этом шифралфавит не обязательно должен состоять из перестановки букв алфавита открытого текста, он может содержать цифры или другие символы.

## Частотный анализ

Долгое время одноалфавитный шифр замены были надежными. Т.к. метод перебора для него был неприменим из-за большого количества возможных шифралфавитов. Но арабским криптоаналитикам удалось сделать прорыв, изобретя частотный анализ.
Для каждого языка, проанализировав большой объем текста, можно определить частоту использования каждой буквы. Для расшифровывания сообщения необходимо также проанализировать частоту появления каждой используемой буквы. Сопоставление распределения частот для букв языка и частоту появления букв в сообщении дает отправную точку для определения используемого шифралфавита. Дальше используются знания языка(возможные, невозможные и наиболее часто встречающиеся сочетания, особенности чередования гласных и согласных), чтобы завершить расшифровывание.

Изобретение частотного анализа склонило чашу весов в сторону криптоаналитиков, потому что сделало нестойкими одноалфавитные шифры замены. Для повышения стойкости использовались различные приемы:

1. пустые символы - есть в шифралфавите, но не соответствуют реальным буквам
1. неправильное написание слов в исходном сообщении
1. номенклаторы - сочетания шифрования и кодирования. Имеется небольшой набор кодов. БОльшая часть сообщения шифруется, а некоторые слова кодируются.

### Кодирование

Если шифрование предполагает замену на уровне символов: символы из алфавита открытого текста заменяются на символы шифралфавита, то *кодирование* предполагает замену на уроыне слов: слов целиком заменяются на соответсвующие им коды. Недостатком кодирования является необходимость составления кодов для всех слов которые будут использоваться в сообщениях. Это само по себе сложно, плюс проблематично добавлять новые слова. А попадание хотя бы одной книги с кодами в руки противника заставит сформировать полностью новый набор кодов.

Несмотря на эти приемы лучшие криптоаналитики успешно расшифровывали большинство сообщений, зашифрованных одноалфавитным шифром замены.

### Омофонический шрифт замены

Призван нейтрализовать возможность частотного анализа путем выравнивания частоты появления букв в сообщении. Для этого одной букве алфавита открытого текста ставится в соответствие `k` букв шифралфавита. Чем более распространена в языке буква, тем больше `k`. Для редких букв так и останется сопоставление один к одному.
Этот шрифт также относят к одноалфавитным шрифтам замены, потому что фактически шифралфавит хоть и предоставляет возможность зашифровать одну и ту же букву разными способами, но в целом шифралфавит определяется один раз и используется для всего сообщения.

### Великий шифр

Использовался во времена Людовика XIV во Франции. В нем шфирование производится на уровне слогов. Каждому слогу сопоставляется число. При расшифровке на эту мысль натолкнуло то, что набор возможных чисел(587) был слишком большим для шифрования на уровне букв, но слишком маленьким длч кодирования слов.
Зацепкой(аналогия со скалолазом) стало повторяющаяся комбинация цифр, которая оказалась фразой *les ennemis*. Наличие какой-то структры в зашифрованном сообщении дает возможность атаковать шифр.

## Влияние изобретения радио

Распространение радиосвязи и азбуки Морзе существенно повысило необходимость в стойком шифре, потому что отныне не нужно искать и подключаться к кокнкретному кабелю - нужно просто поставить антенну и слушать спокойно передачу азбукой Морзе.

## Многоалфавитный шифр замены

Следующим этапом развития криптографии стало использование многоалфавитного шифра замены. Эта идея предалагалась еще в XV веке, но не было разработано стройной системы удобной в использовании.

### Квадрат Вижерена

Суть метода заключается в том, что при шифровании используется `n` шифралфавитов, где `n` соответствует количеству букв в алфавите открытого текста. Каждый следующий шифралфавит сдвинут на одну букву относительно предудущего и по сути представляет собой шифр Цезаря со сдвигом от 0 до n. Отсюда и берется "квадрат": по вертикали `n` букв алфавита, по вертикали `n` различных шифралфавитов.
Выбор каким именно шифралфавитом шифровать конкретную букву сообщения происходит с помощью ключевого слова или фразы. Ключевое слово пишется сверху сообщения так, чтобы буквы были одна над одной. При необходимости ключевое слово повторяется несколько раз. Тогда над каждой буквой сообщения окажется буква из ключевой фразы. Эта буква ключевой фразы будет определять шифралфавит - берем шифралфавит, начинающийся с этой буквы.
Достоинством шифра Виженера является то, что он неуязвим к частотному анализу, потому что одна и та же буква алфавита открытого текста теперь будет представлена разными буквами в зашифрованном сообщении.

Шифр Вижерена был разгадан независимо Чарльзом Бэббиджем и Фридрихом Касиски. Они воспользовались цикличностью в использовании шифралфавитов из-за повторения ключевого слова при шифровании.

#### Уязвимости шифра

> криптографы всеми силами стремяться избегать повторений, поскольку они приводят к появлению упорядоченности и структуры в шифртексте, что является признаком слабости шифра. [1] Механизация шифрования

Кроме уязвимостей самого шифра или алгоритма могут быть слабости, обусловленные тем, как он используется - человеческим фактором. Так во время расшифровки сообщений Энигмы, встречались часто такие разовые ключи как QWE или BNP - символы, расположенные рядом на клавиатуре. Также щифровальщики использовали инициалы в качестве разового ключа. Проблема в том, что человек(тем более в условиях сражения) не может обеспечить требуемый уровень слочайности для ключа. Это похоже на современную ситуацию с паролями - любой смысл в них - это его слабость. Кроме того существовало правило не соединять на штепсельной коммутационной панели соседние буквы, например S и T. Вроде бы в этом есть логика, но в то же время такое правило снижает количество возможных комбинаций для криптоаналитика.

Первым делом Бэббидж искал повторяющиеся последовательности в зашифрованном сообщении, на основе этого делал вывод о длине ключевого слова. А дальше можно было использовать старый добрый частотный анализ для части символов сообщения, соответствующим одной и той же букве ключевого слова, а значит зашифрованных одним шифралфавитом.

#### Длина ключа

Чтобы решить проблему цикличности, логичным использовать ключевые слова, длинна которых совпадала бы с длиной самого сообщения. Но использовать для ключа какую-то смысловую фразу значит дать зацепку для криптоаналитика. Во-первых он сможет начинать с таких часто встречающихся слов как *the*, а также делать предположения исходя из часто встречающихся или наоборот не встречающихся сочетаний букв. Во-вторых, он может проверять себя в процессе дешифрования по тому - какой получается ключ.
В идеале использовать длинные ключи, состоящие из проивольного набора букв. Но это усложняет использование ключа: не так то просто сформировать большое количество длинных ключей и наладить процесс их использования всеми участниками. Поэтому следующий этап развития криптографии был направлен в сторону **автоматизации** процесса шифрования.

## Энигма

Шифровальная машина Энигма была изобретена Артуром Шербиусом.
Основные части:

1. несколько шифраторов
2. штепсельная коммутационная панель
3. отражатель

*Шифраторы* представляли собой толстые резиновые диски с 26(соответствует размеру алфавита) контактами на одной и другой стороне. Провода, находящиеся внутри диска соединяют попарно контакты на противоположны сторонах. То, как соединены провода определяет как будут заифровываться буквы. Последовательно располагаются на одной оси и могут независимо вращаться. Именно они обеспечивают основной механизм шифрования. При каждом вводе буквы первый по счету шифратор поворачивается на одно положение, что эквивалентно смене шфиралфавита. Но, имея только один шифратор, машина имела бы ту же слабость, что и шифр Вижерена - цикличность. Поэтому, когда первый шифратор делает полный оборот, второй шифратор поворачивается на одно положение и так далее. Использовались от 3 до 5 шифраторов. Каждый шифратор иметт 26 положений, что для трех шифраторов дает 17'576 различных положений шифраторов. Более того шифраторы можно менять местами, что добавляет еще 6 вариантов.

*Штепсельная коммутационная* панель делает простую вещь: проводами соединяется пара букв №1 и №2. При вводе буквы №1 на вход шифраторов будет подана буква №2 и наоборот. При шести проводах кол-во возможных способо соединить попарно 26 букв составляет 100'391'791'500.

*Отражатель* предназначен для удобства расшифровывания. Для расшифровывания нужно вводить буквы зашифрованного сообщения на клавиатуру и тогда будут загораться наоборот лампочки с буквами исходного сообщения.

Ключом энигмы было начальное положение:

1. порядок установки ширфаторов
1. начальное положение шифраторов - в какое положение(на какую букву) каждый установлен
1. конфигурация штепсельной коммутационной панели

Именно эти параметры прописывались в кодовых книгах и менялись каждый день. При разработке Энигмы одним из требований было то, чтобы попадание Энигмы в руки криптоаналитиков не давало возможность скомпрометировать шифр. Это как вышеозвученная концепция, когда есть алгоритм и ключ, и именно ключ обеспечивает стойкость шифрования. Сама машина обеспечивала только алгоритм.

### Взлом Энигмы

Ранее криптоаналитиками были в основном знатоки языка, но для взлома Энигмы стали искать ученых, в основном математиков.
Изначально польский криптоаналитик Реевский смог расшифровать Энигму до начала второй мировой войны. Ему это удалось за счет:

1. полякам за счет шпионажа удалось добыть экземпляр Энигмы и правила шифрования
1. по правилам принятым у немецев существовал ключ на день но каждое сообщение шифровалось своим ключом. Для этого до передачи самого сообщения шифровальщик передавал разовую часть ключа - положения шифраторов, т.е. три буквы. Причем для исключения влияния помех при передаче эти три буквы повторялись, например `ABCABC` Но т.к. шифраторы поворачивались одинаковые буквы зашифровывались в разные. Но как известно повторения дают зацепку для криптоаналитика. Реевский мел на руках много зашифрованных сообщений и составлял таблицу соответствий для каждого дня(каждого дневного ключа): какие одинаковые буквы повторенного разового ключа в какие буквы зашифровываются. В итоге накопив большое количество материала, он смог выявить связи между буквами, которые выстраиваются в цепочки.
1. выше приведен вклад каждого элемента машины в стойкость шифра. Как видно штепсельная коммутационная панель вносит бОльшую часть вариативности при зашифровывании. Реевский смог отделить вариации, вносимые возможным положением шифраторов от вариаций, вносимых штепсельной коммутационной панелью, чем существенно упростил себе задачу. Он нашел свойство цепочек, которое не зависит от конфигурации панели.

Изначально работа Реевского была связана с большим объемом ручного труда - он с коллегами потратил год на составление полного каталога связей между буквами. Но потом он смог механизировать поиск ключа. Но главной слабостью его метода было то, что **он работал пока немцы дублируют разовый ключ**.

Перед захватом Польши наработки передали во Францию и Англию. В Англии продолжили развивать методы атаки на шифр Энигмы. Для разработки своей машины для дешифрования были использованы:

1. криб - это наиболее вероятный вариант открытого текста для некоторого отрезка зашифрованного текста. Каждое утро в определенное время немцы передавали сводку о погоде, причем как и соответствует военным правилам формат сводки был фиксированным. Команда ученых и математиков, работающих над расшифровкой, искали слово *wetter*(нем. погода).
2. обнаружили петли, которые образуются при шифровании. Это похоже на связи, обнаруженные Реевским, но они замкнуты.
3. оригинальные идеи Тюринга, который уже к тому моменту представил работы по вычислительным машинам, помогли автоматизировать процесс дешифрования с помощью электрической машины.

Таким образом изначально Шербиус пришел к механизации процесса шифрования, чтобы устранить недостаток стойкого по своей идее шифра Вижерена: трудно обеспечить всех и оперировать длинными произвольными ключами. С другой - для взлома Энигмы также были использованы электро-механические устройства, чтобы сделать за человека работу по перебору возможных комбинаций. А криптоаналитики смогли снизить число возможных комбинаций, чтобы сделать задачу перебора вообще решаемой для устройств того времени.

## Язык племени Навахо

Во время сражений между США и Японией во второй мировой войне американцы использовали радистов из индейкого племени навахо для передачи сообщений. Идея оказалось очень простой, но надежной - в мире просто не было знатоков этого языка и сообщения на нем фактически были зашифрованными для японских криптоаналитиков. Им приходилось работать как археологи расшифровывали иероглифы египтян.

## Цифровая криптография

Развитие компьютеров оказало влияние на криптографию. Во-первых, компьютер оперирует двоичными числами, а не символами, значит требовались новые алгоритмы шифрования. Во-вторых, программируемые компьютеры могут быть использованы для взлома более сложных шифров. Во-вторых, объединение компьютеров в сети и обмен сообщениями между разными компьютерами заставляет задумываться о шифровании этих сообщений. Причем чем более компьютеры входят в повседневную жизнь, тем больше в криптографии нуждаются не только правительство и военные, но также организации и обычные люди. Это обостряет проблему распределения ключей.

### Проблема распределения ключей

Надежные алгоритмы шифрования для компьютеров были разработаны и в США даже принят стандарт DES, на основе шифра Люцифер. Но проблема распределения ключей осталась. Даже при использовании криптографии для ограниченного круга военных и правительства было не просто обеспечить всех участников набором ключей и организовать процесс их смены. При этом надо следить, чтобы ключи не попали не в те руки. В одно время корпорации и банки нанимали специальных курьеров, чтобы они физически везли ключ в другой офис/организацию, с которой нужно обеспечить шифрованное общение.

А что делать, если ключ нужен на каждом персональном компьютере? Возникает парадокс: как зашифровано передать ключ по сети, если для шифрования нужно, чтобы ключ уже был на обоих компьютерах? На определенно этапе развития криптографии эта задача казалась неразрешимой. Но группа исследователей Уитфилд Диффи, Мартин Хеллман, Ральф Меркль разработала алгоритм.

Изначально они пришли к интересной аналогии реального мира: Алиса и Боб хотя обменяться посылкой так, чтобы ее точно никто не вскрыл. Алиса кладет посылку в железный ящик, запирает своим замком и отправляет ее Бобу. Боб получает ящик, навешивает свой замок и отправляет обратно Алисе. Алиса получает ящик, снимает свой замок и отправляет Бобу. Боб получае ящик, снимает свой замок и достает посылку. Таким способом никто не сможет залезть внутрь ящика и посмотреть его содержимое. Проблема применения этой идеи в шифровании в том, что для шифрования важен порядок: если сообщение сначала зашифрует Алиса, а потом результат зашифрует Боб, то Алиса ничего не сможет поделать с результатом - его может расшифровать только Боб своим ключом.

Но они в итоге нашли решение через использование односторонних функций. Суть в том, что имея только результат выполнения необратимой функции, сложно вычислить аргументы, даже если сама функция известная.  Пример такой функции - [[Модулярная арифметика|взяти по модулю]]. Необратимость также является важным свойством [[Hash function|хэш-функций]].

Односторонняя функция - это как смешивание красок: сама функция и ее результат нам известны, но сложно найти исходные цвета. Продолжая аналогию суть разработанного алгоритма в том, что у Алисы и Боба есть по трехлитровой банке, в которую налит литр какой-то краски, пусть желтой. Алиса и Боб добавляют каждый в свою банку свой секретный цвет, например Алиса малиновый, Боб - фиолетоввый. И отправляют банки друг другу. Получив банки друг от друга, они снова добавляют по литру своей секретной краски и в итоге у каждого получается три литра одинакового цвета, это и есть ключ. Таким образом у Алисы и Боба еть один и тот же ключ, который они могут использовать для шифрования. При этом у Ева, которая перехватывает сообщения, знает только о банке и результатах смешения двух цветов, итогого ключа она не знает, потому то не может выделить секретный цвет, после того как его смешали с желтым.

Так решается проблема распределения ключей, но этот подход имеет большой недостаток при широком использовании. Допустим Алиса хочет послать личное сообщение Бобу, обычный email. Чтобы сделать это, ей с Бобом нужно обменяться ключами. Но для этого Боб должен быть онлайн, чтобы отправить ей свою "банку краски".

### Асимметричное шифрование или шифрование с открытым ключом

Теоретическую идею ассиметричного шифрования описал Ричард Диффи. Она заключается в том, что в отличие от симметричного шифрования, которое использует только один ключ, в ассиметричном шифровании предполагается два ключа - один для зашифровывания, другой для расшифровывания.Эта идея решает с одной стороны проблему распределения ключей, с другой - позволяет избежать неудобство с обменом ключами, описанном выше. Для шифрования используется *открытый ключ*. Он так называется, потому что распространяется свободно: все кто хочет отправить сообщение Бобу, должны иметь возможность его получить. Ключ для расшифровывания, *закрытый ключ* наоборот должне хранится только у Боба, чтобы только он мог прочитать то, что ему отправил любой желающий. Если проводить аналогию с замками, то любой может взять замок для Боба, который закрывается простым защелкиванием. Но ключ от всех этих замков есть только у Боба.

Но разработать алгоритм для реализации этой идеи удалось не сразу. В 1977 году был изобретен алгоритм RSA, названный по фамилиям его изобретателей Ривест, Шамир, Адлеман. Он также основывается на односторонней функции, но в нем участвует кусочек секретной информации, закрытый ключ, который делает одностотроннюю функцию обратимой. В основе надежности RSA лежит **сложность математической задачи разложения числа на простые множители**. Алиса выбирает два простых числа `p`,`q` и хранит их в секрете. Она перемножает их и результат `N` фактически будет являться ее открытым ключом. Зашифрованное этим ключом сообщение можно расшифровать только зная `p` и `q`. Если числа выбраны достаточно большие, то требуется огромное количество вычислительных ресурсов и времени для получения всех возможных простых множителей `N`. Как только будет найдет более быстрый алгоритм разложения на простые множители или произойдет технологический прорыв в ввычислительных мощностях, то RSA перестанет быть надежным.

### Цифровая подпись

Алгоритм RSA можно использовать в обратном направлении для реализации цифровой подписи. Алиса может зашифровать несекретный документ своим закрытым ключом и тогда проверить подлинность можно попытавшись расшифровать открытым ключом. Если это успешно происходит, то значит документ действительно был зашифрован Алисой, что эквивалентно ее подписи.

---

## Источники

1. [[Книга шифров]]

## Ссылки

1. link

---
date: 2023-08-18
---
# Load balancing

> load balancing is the process of distributing a set of tasks over a set of resources (computing units), with the aim of making their **overall processing more efficient**. [Wikipedia](https://en.wikipedia.org/wiki/Load_balancing_(computing))

## Реализация балансировщика

Балансировщики могут быть как программными(software), так и физическими(hardware).

### DNS

DNS-серверы поддерживают функцию при запросе IP адреса по доменному имени выдавать не конкретный фиксированный адресс, а один из допустимого диапазона. Тогда каждый сервер в системе должен иметь [публичный IP](https://en.wikipedia.org/wiki/IP_address#Public_address) и эти адреса должны быть указаны в конфигурации DNS.

Недостатокм является то, что IP адрес, полученный от DNS может кэшироваться на разных уровнях(сами DNS серверы, промежуточные узлы сети, ОС, браузер) и на разное время. Это значит, что нагрузка будет банасироваться неравномерно.

### Отдельный сервис

Отдельный сервис, который единственный в системе будет иметь публичный IP и принимать все запросы к системе. Дальше он уже будет по какому-то алгоритму передавать эти запросы на выполенние одному из серверов. Серверы в этом случае будут иметь уже приватные IP адреса. Здесь можно реализовать уже более хитрую стратегию балансировки, например учитывать нагрузку на конкретные серверы, чтобы не заваливать и без того нагруженный сервер или слабый по мощности сервер.

## Протокол взаимодействия

Балансировщики должны принимать только *https* для обеспечения безопасности, а дальше уже можно общаться по *http* тем самым экономим ресурсы на криптографии, не устанавливать ssl сертификаты на каждую машину в дата центре. Балансировщик(или несколько) - это единственна точка входа в датацентр(См. [demilitarized zone](https://en.wikipedia.org/wiki/DMZ_(computing)).) и внутри все безопасно(с высокой доле вероятности)

Балансировщик перед веб серверами может использовать данные запроса для умного роутинга запросов. А вот балансировщик перед серверами БД это делать гораздо сложнее, потому что трафик тут уже в виде бинарных данных, а не строка как в *http*, приходящем в балансировщик перед веб-серверами.

## Redundancy

Чтобы балансировщик не стал единой точкой отказа ему также добавляют избыточности, т.е. вместо одного балансировщика работают два. Могут быть *active-active* или *active-passive* схемы работы.

## Георепликация

Георепликация может быть реализована на уровне DNS. Я нахожусь в Европе и ввожу google.com, DNS мне выдает IP дата центра, находящегося в Европе. Если я делаю то же самое в Азии, то DNS меня направит в дата центр Азии.

---

## Источники

1. [Lecture 9 Scalability Harvard Web Development David Malan](https://youtu.be/-W9F__D3oY4)

## Ссылки

1. link

---
date: 2024-02-01
---
# Linearizability

–¢–∞–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–æ–ø–∏–π –¥–∞–Ω–Ω—ã—Ö, –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç —Ä–∞–±–æ—Ç—ã —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º.

> ... linearizability is a recency guarantee. [1]

–≠—Ç–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ–ø–∏–µ–π –¥–∞–Ω–Ω—ã—Ö: –≤—ã—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ —Å–∞–º–æ–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç [[Read your writes]] –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç *recency guarantee* –∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

![Linearizability for two clients](../Images/Linearizability%20for%20two%20clients.png)
–ò—Å—Ç–æ—á–Ω–∏–∫: [4]

–í —Å–ª—É—á–∞–µ [[Causal cosistency]] *concurrent* –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã **–ª–æ–≥–∏—á–µ—Å–∫–∏–º** –æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º *happens before*. –ê –≤ —Å–ª—É—á–∞–µ –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç–∏ –º—ã –≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ *real time order*, —Ç–æ –µ—Å—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ A –∏ B –Ω–µ —Å–≤—è–∑–∞–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º, –Ω–æ A –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –¥–æ –Ω–∞—á–∞–ª–∞ B, —Ç–æ –∏—Å—Ö–æ–¥—è –∏–∑ *real time order* –º–µ–∂–¥—É –Ω–∏–º–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫: —Å–Ω–∞—á–∞–ª–∞ –ê, –ø–æ—Ç–æ–º –í. –≠—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è, –Ω–æ –∏ –º–µ–∂–¥—É —á—Ç–µ–Ω–∏—è–º–∏: –µ—Å–ª–∏ –æ–¥–Ω–æ —á—Ç–µ–Ω–∏–µ A –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å —Ä–∞–Ω—å—à–µ B, —Ç–æ B –Ω–µ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –±–æ–ª–µ–µ —Ä–∞–Ω–Ω—é—é –≤–µ—Ä—Å–∏—é, —á–µ–º —É–∂–µ –≤–µ—Ä–Ω—É–ª–æ A.
–ù–æ –µ—Å–ª–∏ —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ç–æ —Ç—É—Ç –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—É—é –Ω–µ–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –≥–¥–µ –∏–º–µ–Ω–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–∫–∞–∂–µ—Ç—Å—è *—Ç–æ—á–∫–∞ –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç–∏* üëá.

> Linearizable history can be expressed as a sequence of instantaneous operations that preserves the original operation order. [2]

![Linearizability](../Images/Linearizability.png)
–ò—Å—Ç–æ—á–Ω–∏–∫: [1]

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –º–µ–∂–¥—É –ø–æ–ª—É–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤—Ä–µ–º—è, –≤ —Å–ª—É—á–∞–µ –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –≥–¥–µ-—Ç–æ –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–≥–æ –ø—Ä–æ–º–µ–∂—É—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–æ–º–µ–Ω—Ç (*linearizability point*), –≤ –∫–æ—Ç–æ—Ä—ã–π **–∞—Ç–æ–º–∞—Ä–Ω–æ** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è. –≠—Ç–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –∑–∞–ø–∏—Å—å, —Ç–∞–∫ –∏ —á—Ç–µ–Ω–∏–µ.

## –û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏ [[Leader election]]

–ï—Å–ª–∏ –Ω–µ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å, —Ç–æ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç:

- –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –≤–æ–∑—å–º–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞–Ω—è—Ç–∞ –æ–Ω–∞ –∏ –ø–æ–ª—É—á–∏—Ç –æ—Ç–≤–µ—Ç "—Å–≤–æ–±–æ–¥–Ω–∞". –í –∏—Ç–æ–≥–µ –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥—É—Ç –¥—É–º–∞—Ç—å, —á—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É –Ω–∏—Ö
- –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç *split brain*

–ß–∞—Å—Ç–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ leader election –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ *Zookeeper* –∏  *etcd*.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–ù–∞–ø—Ä–∏–º–µ—Ä, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±–µ—Ä–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ª–æ–≥–∏–Ω–µ –∏ –≤—Ç–æ—Ä–æ–π –ø—Ä–æ—Ü–µ—Å—Å —É–∂–µ –Ω–µ —Å–º–æ–∂–µ—Ç –µ–µ –∑–∞–Ω—è—Ç—å.
–î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä - –ø—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç/—Å–∞–º–æ–ª–µ—Ç. –ê –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ - –∫–∞–∂–¥–æ–µ –º–µ—Å—Ç–æ –º–æ–∂–µ—Ç –∫—É–ø–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–≤–æ–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–∞–±—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏, –Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –º–µ—Å—Ç–æ –∫—É–ø–∏–ª–∏ —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.
–ï—â–µ –ø—Ä–∏–º–µ—Ä - –±–∞–ª–∞–Ω—Å –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ —Å—á–µ—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º.

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

1. [[Single leader replication]] —Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å. –ù–æ –æ–ø—è—Ç—å –∂–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ *snapshot isolation* –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∏—Ç—å –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å.
1. [[Leaderless replication]] —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º [[Quorum]] –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ [[Quorum|read repair]].
1. [[Consensus]]. –° –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç–∏ üëá.

> The clients interact with the replicated state machine via commands. These commands are given to the consensus module, which determines if it is possible to commit the command to the replicated state machine and, if possible, does so. The state machine must be deterministic, so that when commands are committed the state machines remain identical. A fault-tolerant database is an example of one such application. Once a command has been committed, the consensus protocol guarantees that eventually the command will be committed on every live state machine and they will be committed in order. This provides linearisable semantics from the client, defined as each command from the client appearing to execute instantaneously, exactly once, at some point between its invocation and positive response. [3]

## Linearizability and CPU

> üí° Even CPUs do not offer linearizability when accessing main memory by default. [2]

–≠—Ç–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ —Ç–µ–º, —á—Ç–æ –∫–∞–∂–¥–æ–µ —è–¥—Ä–æ CPU –∏–º–µ–µ—Ç —Å–≤–æ–π –∫—ç—à –∏ –º–æ–∂–µ—Ç –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç—Ç—É–¥–∞, –∞ –Ω–µ –∏–∑ *main memory*. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏–º–µ–µ–º —Å–∏—Ç—É–∞—Ü–∏—é —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–ø–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö. –í .NET –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ [[–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è|volatile]]

---

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏

1. [[Designing Data-Intensive Applications book]]. Chapter 9.
1. [[Database Internals book]]. Replication and consistency.
1. [ARC: Analysis of Raft Consensus. Heidi Howard](https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-857.pdf)
1. [Distributed Systems lecture series. 7.2. Martin Kleppmann](https://youtu.be/noUNH3jDLC0?si=RhwohabtNHe-NzJ6)

## –°—Å—ã–ª–∫–∏

1. [Distributed Systems 7.2: Linearizability. Martin Klepman](https://youtu.be/noUNH3jDLC0?si=_PCaU9wISRHN--xt)

---
date: 2022-01-01
tags:
    - messagequeue
---
# Pull vs Push

Очереди сообщений могут реализовывать разные паттерны(pull vs push) на публикацию и потребление сообщений. При этом возможно использование комбинации паттернов в рамках одной очереди.

Традиционным считается подход, когдс producer использует push, а consumer - pull.

## Pull model

### Produce

Вариант реализации: Producer может сохранять сообщения в БД, а брокер будет читать эти сообщения.

### Consume

Преимущества:

1. позволяет и переобрабатывать сообщения. Например в Kafka consumer просто указывает нужный офсет, с которого ему брокер должен отдать сообщения.
1. consumer сам регулирует кол-во забираемых сообщений с учетом своих возможностей. Актуально, например, в случае DOS атаки. Тогда как в *push-модели* брокер будет пушить консьюмер и нужно будет как-то предусматривать *backoff*/*backpresure* на случай, если консьюмер не справляется
1. консьюмер может брать несколько сообщений батчем, что повышает производительность. В совокупности со п.2 консьюмер сам выбирает, когда готов принять следующие соообщения и затягивает весь накопившейся за это время батч. В push моделе возникает компромис: пушить как только появляется сообщение(быстрота доставки) или же буферизировать их и пушить потом пачку сообщений(эффективность)

---

## Ссылки

1. [[Kafka design]]

## Источники

1. [Kafka documentation](https://kafka.apache.org/documentation/#design)

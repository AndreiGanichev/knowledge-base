---
date: 2022-09-06
tags:
    - tag
---

Несмотря на то, что важная характеритика BC - это автономность, между ними все-таки чаще всего должны быть интеграции. Что кстати приводит к необходимости коммуникаций между работающими над BCs командами.

### Виды отношений между BC

Различные варианы связи между BC во многом определяются взаимоотношениями между командами, работающими в этих BC:

1. качество коммуникаций
1. насколько связаны цели команд: они выигрывают всегда только вместе или одна зависит от сервиса, предоставляемого другой

### Контракт

Интеграция BCs означает наличие точки соприкосновения между ними - *контракта*. Типы связей в конечном счете определяют **какой язык будет выбран для контракта**.

### Cooperation

Условия:
1. цели команд общие или связанные, т.е. выигрывают вместе
1. либо интегрируемые BC принадлежат вообще одной команде, либо разным но с хорошими коммуникациями


#### Partnership

Наиболее тесная связь, формируемая ad hoc: понадобилось расширение контракта - пошел и сделал. У команд общие цели, протеворечия насчет контрактов решаются эффективно, потому что обе стороны заинтересованы. Никто не диктует язык контракта, а каждый раз коллективно выбирается подходящее решение.

#### Shared Kernel
SK - это *пересечение моделей из разных BC*. SK может иметь смысл, когда в одном SD спроетировано больше одного BC. 

Фактически SK является нарушением правила независимости моделей в разных BC. Плюс получается так что SK, принадлежащий одновременно нескольким контекстам, разрабатывается оновременно несколькими командами, что также протеворечит правилам BC.

Использование SK - это выбор между независимостью и дублированием: можно сделать модели полностью независимыми и продублировать общую часть вместо вынесения в SK. Каждый раз нужно смотреть что дешевле: интеграция через SK или дублирование(что влечет необходимость синхронизации продублированной логики). Вариант с дублированием точно не подходит для Core SDs, потому что логика в них особенно сложная.

Т.о. нужно стремиться сделать размер SK минимально возможным(так проще поддержать его консистентность во всех заинтересованных BC) и состоящим действительно только из частей, актуальных для всех интегрируемых контекстов.

При использование SK обязательными становятся:
1. построение работы таким образом, что обновление SK сразу становилось видимым для всех использующих его BCs. Прямая ссылка в случае монорепозитория или пакеты в случае разных репозиториев
1. практики [[Continious Integration]], чтобы держать код SK максимально актуальным в условиях разработки несколькими командами
1. автоматизированного интеграционного тестирования, чтобы проверять интеграцию последней версии SK со всеми заинтересованными BCs

**В идеале SK содержит только контракты**, то есть структуры данных актуальные для UL в обоих BC. Т.е. общение между BC ведется на понятном обоим моделям языке.

Когда использовать:
1. когда Partnership сложно использовать из-за недостаточно хороших коммуникаций, например распределенные команды
1. опасность паттерна *Partnership* в том, что есть шанс постепенного размытия границ *BC*. *SK* же сохраняет строгими границы и явно выделяет общую часть моделей.
1. как временное решение при разделении на контексты legacy системы

---

### Источники:
1. link

### Ссылки:
1. link
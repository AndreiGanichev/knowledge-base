---
date: 2023-03-08
tags:
    - tag
---

**Balanced tree** - наиболее широко распространенная в СУБД структура данных, давно известна и хорошо изучена. Представляет собой сбалансированное(глубина log(n)) дерево. В вершинах дерева расположены страницы фиксированного размера, обычно 4 Кб. Является изменяемой(*mutable*) структурой. С этой точки зрения B-tree противопоставляется [[Log structured storage]]. 
При этом их используют и вместе:
- индексы для отдельных сегментов(файлов) [[LSM tree]] могут выполняться в виде B-tree. 
- *write ahead log* используется для того, чтобы сделать B-tree надежной и не терять изменения
- Иц

По умолчанию(всегда надо смотреть на конкретный профиль нагрузки) оптимизирована для чтения.

## Достоинства
1. отсутствует [[Space amplification]] - данные хранятся в одном экземпляре
1. структура данных давно известна, хорошо изучена и оптимизирована

## Недостатки

1. [[Random write]] - сначала ищется нужная страница и только потом она точечно перезаписывается
1. [[Write amplification]] - даже если меняется только часть страницы, она все равно перезаписывается на диск целиком. Если при изменении еще приходится делать *split*, то перезаписать придется три страницы
1. страницы имеют фиксированную длину и некоторую область приходится резервировать на будущее, чтобы удовлетворить последующие вставки ключей
1. чтобы не "сломать" структуру дерева при конкуррентной записи приходится использовать *lock*. Альтернативой является [[Latch]] - более легковесный механизм.

## Split and merge

## Оптимизации

---

### Источники:
1. link

### Ссылки:
1. link